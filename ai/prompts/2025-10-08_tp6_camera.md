---
Title: TP6 – Caméra (galerie, capture, détail)
Date: 2025-11-18T00:00:00Z
Owner: Mathys
Scope: `app/(main)/tp6-camera/*`
OutOfScope: DB robots
---

## Objectif

Créer une galerie locale avec capture via `expo-camera`, permissions, stockage fichiers, et écran détail (partage/suppression).

## Contexte

- Galerie: grid 3 colonnes, pull-to-refresh, FAB pour lancer la caméra.
- Caméra: permission, switch front/back, capture et sauvegarde locale.
- Détail: aperçu, partage `expo-sharing`, suppression.
- Stockage: `documentDirectory/photos` avec métadonnées JSON (id, uri, size, createdAt).

## Contraintes

- Demande de permission explicite + lien vers réglages si refus.
- Sauvegarde robuste (extensions: jpg/png/heic/webp) avec fallback jpg.
- Ne pas bloquer l’UI pendant la capture (loader).

## Étapes proposées à l'IA (agent)

1. Hook `useCameraPermission` (request, état loading/granted, openSettings).
2. Hook `usePhotoStorage` (list/add/remove) + services fichiers.
3. Écrans: galerie → caméra → retour; détail avec partage/suppression.
4. Auto-revue: gestion des erreurs, tailles d’images, tri par date.

## Critères d'acceptation

- Capture → photo visible en galerie; suppression → disparait.
- Partage disponible si supporté, message sinon.

## Plan de test minimal

- Permission accordée/refusée → comportements attendus.
- Extensions diverses → sauvegarde et lecture OK.

## Risques & mitigations

- Permissions instables: fallback messages + ouverture réglages.
- Chemins fichiers: utiliser `documentDirectory` ou `cacheDirectory` fallback.
